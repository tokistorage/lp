<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="asset/favicon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="asset/apple-touch-icon.png">
    <title>機種依存・ブラウザ依存・組織依存の断層 | トキストレージ</title>
    <meta name="robots" content="noindex, nofollow">
    <meta name="description" content="iPhone Safariで印刷ボタンを消し、PC Safariでも印刷を諦め、macOS Chromeだけに絞った記録。機種依存・ブラウザ依存・組織依存、三つの断層に向き合い「捨てる」と決めることで見えた設計の起点。">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;600;700&family=Zen+Kaku+Gothic+New:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --toki-blue: #2563EB;
            --toki-blue-dark: #1D4ED8;
            --toki-blue-pale: #EFF6FF;
            --accent-blue: #3B82F6;
            --bg-white: #FFFFFF;
            --text-primary: #1E293B;
            --text-secondary: #475569;
            --text-muted: #94A3B8;
            --border: #E2E8F0;
            --font-display: 'Shippori Mincho', serif;
            --font-body: 'Zen Kaku Gothic New', sans-serif;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }
        body { font-family: var(--font-body); font-weight: 400; background: var(--bg-white); color: var(--text-primary); line-height: 2; font-size: 16px; }

        .article-nav { position: fixed; top: 0; left: 0; right: 0; z-index: 1000; background: rgba(255,255,255,0.95); backdrop-filter: blur(12px); border-bottom: 1px solid var(--border); padding: 0.6rem 1.2rem; display: flex; align-items: center; justify-content: space-between; gap: 1rem; }
        .article-nav .nav-brand { font-family: var(--font-display); font-size: 0.9rem; font-weight: 600; color: var(--toki-blue); text-decoration: none; white-space: nowrap; }
        .article-nav .nav-brand::before { content: ''; display: inline-block; width: 20px; height: 20px; background: url('asset/tokistorage-icon-512.png') no-repeat center / contain; vertical-align: -3px; margin-right: 5px; }
        .article-nav .nav-right { display: flex; align-items: center; gap: 1rem; }
        .article-nav .nav-label { font-size: 0.6rem; color: var(--text-muted); letter-spacing: 0.08em; }
        .article-nav .lang-switch { font-size: 0.75rem; color: var(--toki-blue); text-decoration: none; padding: 0.3rem 0.6rem; border: 1px solid var(--toki-blue); border-radius: 4px; }
        .article-nav .lang-switch:hover { background: var(--toki-blue); color: #fff; }

        .article-container { max-width: 680px; margin: 0 auto; padding: 7rem 2rem 4rem; }
        .article-header { margin-bottom: 3rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border); }
        .article-category { font-size: 0.7rem; color: var(--toki-blue); letter-spacing: 0.15em; margin-bottom: 1rem; }
        .article-header h1 { font-family: var(--font-display); font-size: 1.8rem; font-weight: 700; line-height: 1.5; margin-bottom: 1.5rem; }
        .article-subtitle { font-size: 0.95rem; color: var(--text-secondary); line-height: 1.9; }

        .article-content h2 { font-family: var(--font-display); font-size: 1.3rem; font-weight: 600; margin: 3rem 0 1.5rem; padding-bottom: 0.5rem; border-bottom: 2px solid var(--toki-blue-pale); }
        .article-content h3 { font-family: var(--font-display); font-size: 1.1rem; font-weight: 600; margin: 2rem 0 1rem; color: var(--toki-blue-dark); }
        .article-content p { margin-bottom: 1.5rem; text-align: justify; }
        .article-content blockquote { border-left: 3px solid var(--toki-blue); padding-left: 1.5rem; margin: 2rem 0; font-family: var(--font-display); color: var(--text-secondary); }
        .article-content ul { margin: 1.5rem 0; padding-left: 1.5rem; }
        .article-content li { margin-bottom: 0.75rem; }

        .core-message { background: var(--toki-blue-pale); border-left: 4px solid var(--toki-blue); padding: 1.5rem; margin: 2rem 0; font-size: 0.95rem; line-height: 1.8; }
        .key-point { background: linear-gradient(135deg, var(--toki-blue-pale) 0%, #fff 100%); border: 1px solid var(--accent-blue); border-radius: 8px; padding: 1.5rem; margin: 2rem 0; text-align: center; }
        .key-point p { font-family: var(--font-display); font-size: 1.1rem; color: var(--toki-blue-dark); margin: 0; }

        .article-footer { margin-top: 4rem; padding-top: 2rem; border-top: 1px solid var(--border); text-align: center; }
        .article-footer p { font-size: 0.8rem; color: var(--text-muted); margin-bottom: 1rem; }
        .article-footer a { color: var(--toki-blue); text-decoration: none; }
        .article-footer a:hover { text-decoration: underline; }

        @media (max-width: 768px) {
            .article-container { padding: 6rem 1.2rem 3rem; }
            .article-header h1 { font-size: 1.5rem; }
            .article-nav .nav-label { display: none; }
        }
        @media print { .article-nav { display: none; } .article-container { padding-top: 2rem; } }
    </style>
    <link rel="stylesheet" href="contact-form.css">
    <meta property="og:image" content="https://tokistorage.github.io/lp/asset/tokistorage-icon-512.png">
    <meta property="og:image:width" content="512">
    <meta property="og:image:height" content="512">
</head>
<body>

<nav class="article-nav">
    <a href="index.html" class="nav-brand">トキストレージ</a>
    <div class="nav-right">
        <span class="nav-label">技術・設計 / Technology</span>
    </div>
</nav>

<main class="article-container">

    <header class="article-header">
        <p class="article-category">ESSAY &mdash; 技術・設計</p>
        <h1>機種依存・ブラウザ依存・組織依存の断層<br><span style="font-size: 0.6em; font-weight: 400; color: var(--text-secondary);">&mdash;&mdash; 捨てる決断が照らす設計の起点</span></h1>
        <p class="article-subtitle">
            iPhone Safariで印刷ボタンを消し、PC Safariでも印刷を諦め、<br>
            macOS Chromeだけに絞った記録から、組織の中で引き継がれない知識の問題へ。<br>
            三つの断層に向き合い、「捨てる」と決めることで見えたもの。
        </p>
    </header>

    <article class="article-content">

        <div class="core-message">
            <strong>この記事で言いたいこと：</strong>機種依存も、ブラウザ依存も、組織依存も、根は同じ問題を抱えている。「すべてに対応する」という理想が、かえって品質を蝕む。境界を引き、捨てると決めることが、本当に守るべきものを照らす。
        </div>

        <h2>1. 試行錯誤の記録</h2>

        <p>TokiQRのplay.htmlにPC向け印刷機能を実装した。A4横のレイアウトに、QRコードとメタデータを配置し、二ページ目にはブローシャを収めた。PCのブラウザで「印刷」を押せば、そのまま美しいシートが出力される。声を閉じ込めたQRコードが、物理的な紙の上に降り立つ瞬間だ。</p>

        <p>当然のように思った。同じ体験をiPhone Safariでも提供しよう、と。</p>

        <p>そこから始まった試行錯誤は、30を超えるプルリクエストに刻まれている。QRコードの表示サイズを150mmから115mmへ、さらに108mmへ。@pageのマージンを何度も書き換えた。100vhを固定mmに置き換え、ネガティブマージンで微調整し、iframeでの描画を試し、PNG画像への変換を試し、Service Workerのキャッシュが邪魔をする問題と格闘した。</p>

        <p>一つ直せば別の場所が崩れる。97%のビューポートで収まるが、100%ではみ出る。その3%の隙間に、デスクトップとモバイルの間に横たわる深い溝が見えた。</p>

        <blockquote>
            3%の余白に潜む溝は、技術的な問題ではなかった。<br>
            設計思想の断層だった。
        </blockquote>

        <p>iOS Safariは<code>@page { size }</code>を無視する。<code>column-count: 2</code>はiframe内で機能しない。<code>window.print()</code>にはユーザージェスチャーの制約がある。一つひとつは些細な制限に見える。だがそれらが重なったとき、「モバイルでの印刷」という体験は、砂上の楼閣になった。</p>

        <h2>2. 境界の発見</h2>

        <p>ブラウザの印刷APIは、デスクトップを前提に設計されている。</p>

        <p>これは非難ではない。歴史的な事実だ。印刷という行為は、大きな画面で文書を確認し、接続されたプリンターに出力するという、物理的な作業環境を想定して設計された。モバイルブラウザがその機能を「サポートしている」のは事実だが、サポートしていることと、信頼できる体験を提供することの間には、埋めがたい距離がある。</p>

        <p>モバイルで「ほぼ動く」は、「動かない」と同義だ。</p>

        <p>98%のケースで正しく表示されるレイアウトは、残り2%で崩れる。QRコードが紙の端で切れる。二段組みが一段に戻る。余白が消えて文字が詰まる。ユーザーはその2%に遭遇したとき、「たまたま崩れた」とは思わない。「このサービスは壊れている」と思う。</p>

        <blockquote>
            98%で崩れるレイアウトは、ユーザーの信頼を100%損なう。
        </blockquote>

        <p>技術者にとっての98%は「ほぼ完成」だ。だがユーザーにとっての98%は「壊れている」だ。この認知の非対称性に気づいたとき、問題の本質が見えた。これは実装の問題ではない。そもそもモバイルブラウザで本番品質の印刷を提供するという前提が、現時点では成り立たないのだ。</p>

        <h2>3. ブラウザ依存の断層</h2>

        <p>モバイルの印刷ボタンを消した。これで解決したはずだった。</p>

        <p>だがPC Safariが、新たな断層を突きつけてきた。macOS上のChromeでは2ページに収まる印刷レイアウトが、同じmacOS上のSafariでは4ページに散る。コンテンツが次のページにはみ出し、空白のページが挿入される。</p>

        <p>原因を探った。Safariの印刷エンジンは、<code>overflow: hidden</code>を無視する。Flexコンテナに設定した<code>height</code>制約も無視する。<code>break-inside: avoid</code>も機能しない。CSSで「ここからはみ出すな」と指示しても、印刷エンジンがその指示を尊重しない。</p>

        <p>さらに10以上のPRを重ねた。高さを180mmから178mmへ、マージンを10mmから13mmへ。ルーラー要素でmm→px変換を試み、<code>beforeprint</code>イベントで<code>transform: scale()</code>による強制縮小まで実装した。CSSだけでは無理だから、JavaScriptで力技で押し込もうとした。</p>

        <p>すべて無駄だった。同じHTMLを、同じCSSで描画しているのに、結果が異なる。機種の違いではない。OSの違いでもない。同じマシンの上で、レンダリングエンジンが異なるだけで、印刷結果が変わる。画面表示では差異のないCSSプロパティが、印刷時にはまったく異なる挙動を示す。</p>

        <p>これはバグではない。WebKitとBlinkの、印刷エンジンにおける設計思想の違いだ。仕様書に書かれていないグレーゾーンを、それぞれのエンジンが異なる方法で解釈している。</p>

        <blockquote>
            機種を揃えても、OSを揃えても、ブラウザが異なればレイアウトは崩れる。<br>
            ブラウザ依存は、機種依存より深い断層だ。
        </blockquote>

        <h2>4. 失うという決断</h2>

        <p>二度、捨てた。</p>

        <p>最初にモバイルの印刷を捨てた。次にSafariの印刷を捨てた。印刷機能が動作する環境は、macOSのChromeだけになった。30以上のPRで積み重ねた試行錯誤の結果として「Chromeでしか動きません」と認めることは、技術者としての矜持に触れる。もう少し工夫すれば、もう少し時間をかければ、きっと解決できる。そう思いたかった。</p>

        <p>だが「もう少し」の先にあるのは、脆い体験の上に築かれた機能だ。今日直しても、次のSafariアップデートで崩れるかもしれない。その不安を抱えながら機能を提供し続けることは、誠実ではない。</p>

        <h3>失ったもの</h3>

        <p>Safari、Firefox、モバイル——Chrome以外のすべての環境で印刷する導線を失った。iPhoneで録音し、QRコードを生成し、その場で印刷するという一気通貫のワークフローは消えた。</p>

        <h3>得たもの</h3>

        <ul>
            <li><strong>壊れた体験を届けないという品質保証</strong>——ユーザーが「印刷」を押して期待を裏切られることはない</li>
            <li><strong>注文ボタンへの明確な誘導</strong>——印刷の代わりに、プロが仕上げた高品質なQRシールを注文する導線が前面に出る</li>
            <li><strong>Chrome印刷の品質に集中できる余地</strong>——クロスブラウザ対応に費やしていたリソースを、一つのブラウザの完成度に向けられる</li>
        </ul>

        <p>「ご自身で印刷する場合はPC（macOS）のChromeをご利用ください」——この一文を添えた。機能を削除したのではない。機能を配置し直したのだ。Chromeで「だけ」ではなく、「Chromeが最善」であるという案内。それは制限ではなく、最適化だ。</p>

        <blockquote>
            捨てたのは機能ではない。<br>
            「すべてのブラウザで同じ体験を」という、実現不可能な約束を捨てた。
        </blockquote>

        <h2>5. もう一つの断層——組織依存</h2>

        <p>機種依存の問題を掘り下げるうちに、既視感に気づいた。これは端末やブラウザだけの話ではない。同じ構造が、組織の中にもある。</p>

        <p>大規模案件では、デザイン組織とエンジニア組織が分離している。意思決定ラインが噛み合わない。ベンダーが複数入り、「対応済み」と「スコープ外」が乱立する。顧客への説明は文書化されず、何が約束されたのか、誰も正確に把握できない。責任者の階層が増えるほど、「それは私の判断ではない」という逃げ場が増えていく。</p>

        <p>結果、皺寄せは現場に落ちる。</p>

        <p>末端のエンジニアが、仕様の曖昧さを吸収し、矛盾する要件の帳尻を合わせ、ドキュメントのない決定事項を推測で補う。iOS Safariが<code>@page { size }</code>を無視するように、組織の中間層は現場の制約を無視する。そしてエンジニアは、3%の隙間を埋めるために30以上のPRを書く——端末に対しても、組織に対しても。</p>

        <blockquote>
            機種依存と組織依存は、構造が同じだ。<br>
            「対応済み」という言葉が、現実との乖離を覆い隠す。
        </blockquote>

        <p>「全端末対応」と「全ステークホルダー合意済み」は、同じ種類の幻想だ。仕様書の上では成り立つが、現場では成り立たない。その差異を吸収し続ける限り、品質は永遠に脆いままだ。</p>

        <h2>6. 引き継がれない知識</h2>

        <p>大規模案件でよく見る光景がある。PoCで「できること」を証明する。技術的にフィージブルであると報告される。そしてPoCは燃え尽きて終了する。</p>

        <p>引き継ぎ文書はない。なぜその技術選定をしたのか、どこに落とし穴があったのか、何を試して何を捨てたのか。PoCを担当したエンジニアの頭の中にだけ残っていた知識は、契約終了とともに消える。次のフェーズを担う別のベンダーは、同じPoCをやり直す。同じ落とし穴に落ち、同じ結論に辿り着き、同じように燃え尽きる。</p>

        <blockquote>
            記録されなかった知識は、存在しなかったのと同じになる。
        </blockquote>

        <p>TokiQRの印刷機能で30以上のPRを重ねた記録は、GitHubに残っている。97%で収まるが100%ではみ出るという発見も、<code>display: none</code>のiframe内ではコンテンツが描画されないという知見も、Service Workerのキャッシュがクエリパラメータを無視するという罠も。すべてコミットログとPRの議論に刻まれている。</p>

        <p>もしこれが大規模案件の一工程だったらどうか。PoCとして「モバイル印刷は技術的に困難」と報告され、次のベンダーが引き継ぎ、同じ試行錯誤を繰り返す。あるいは「困難」の一言で片付けられ、なぜ困難なのかの詳細は失われる。</p>

        <p>個人開発には、この点で決定的な強みがある。試行錯誤のすべてが、一つのリポジトリに連続した文脈として残る。判断の理由が追跡可能であり、失敗も含めて記録される。組織の中では分断される知識が、ここでは一本の線としてつながっている。</p>

        <h2>7. 存在証明のインフラとして</h2>

        <p>「引き継がれないPoC」と「記録されない人の存在」は、根っこが同じ問題だ。</p>

        <p>知識が記録されなければ、それは存在しなかったことになる。技術者の試行錯誤が引き継がれなければ、組織はその知見を失う。人の声が記録されなければ、その人が何を語り、何を感じていたのかは、時間とともに消えていく。</p>

        <p>トキストレージは「声と記憶を1000年先に届ける」サービスだ。TokiQRはそのための技術基盤であり、QRコードは声を物理世界に定着させる接点だ。この事業の根底にあるのは、「記録されなかったものは存在しなかったことになる」という認識への抵抗だ。</p>

        <p>Zennへの60冊以上の技術書の執筆も、同じ衝動から来ている。PoCの報告書には書けない、判断の理由や試行錯誤の過程。公式ドキュメントには残らない、現場の肌感覚。それらを書き残すことは、技術知識の「存在証明」への抵抗だ。記録しなければ、考えたことすら存在しなかったことになる。</p>

        <p>この文脈で問うべきは、「すべての端末で印刷可能か」ではない。「確実に届く体験か」だ。</p>

        <p>物理的なQRシールは、注文を通じて高品質に提供できる。UV印刷とラミネート加工を施した、耐候性のあるシール。それは家庭用プリンターの出力とは次元の異なる品質だ。モバイルで不安定な印刷を提供するよりも、プロの品質で届けるほうが、サービスの本質に近い。</p>

        <p>1000年先に届けることを約束するサービスが、手元の端末で崩れる印刷を提供していたら、その約束は信じてもらえるだろうか。機種依存やブラウザ依存という現実を受け入れることは、サービスの誠実さにつながる。</p>

        <h3>検証された仮説——物理化の難易度</h3>

        <p>30以上のPRを経て見えたのは、技術的な限界だけではない。「デジタルデータを物理的な成果物にする」という行為そのものの難易度が、期待以上に高いという事実だ。</p>

        <p>端末を選び、ブラウザを指定し、用紙の向きを設定し、余白を調整し、ヘッダとフッタをオフにする。技術者ですら安定しなかった体験を、一般のユーザーに求めることは現実的ではない。これは30以上のPRで検証された、実証的な知見だ。</p>

        <p>この知見は、注文サービスの存在意義を裏付ける。「印刷できないから注文してください」ではない。「物理化は本質的に難しいから、プロに委ねるのが合理的です」という説明が、技術的な根拠をもって成立する。UV印刷とラミネート加工を施した耐候性のあるシールは、家庭用プリンターの出力とは品質の次元が異なる。自力での物理化が難しいからこそ、プロの品質に価値がある。</p>

        <blockquote>
            「自分でもできるけど注文したほうがいい」よりも、<br>
            「自分でやると実は難しい、だから注文がある」のほうが、<br>
            注文動機として自然で、誠実だ。
        </blockquote>

        <div class="core-message">
            正しい分業とは、すべてを一つの場所で完結させることではない。それぞれの場所で最善を尽くすことだ。モバイルは録音と生成に集中する。物理化はプロの品質に委ねる。知識はコミットログと技術書に残す。その割り切りが、全体の信頼を守る。
        </div>

        <h2>8. 設計者への問い</h2>

        <p>あなたのプロダクトにも、「捨てるべき98%」はないだろうか。あなたの組織にも、「引き継がれないPoC」はないだろうか。</p>

        <p>ほぼ動くが完全ではない機能。対応しているが信頼できない環境。提供できるが品質を保証できない体験。それらを「対応済み」と表示し続けることは、ユーザーへの誠実さだろうか。PoCで「できること」を証明して、その知見を文書化せずに次のフェーズに進むことは、組織への誠実さだろうか。</p>

        <p>全端末対応という言葉は、仕様書では美しく響く。全ブラウザ対応という言葉も、要件定義書では美しく響く。全ステークホルダー合意済みという言葉も、議事録では美しく響く。だが現実の端末は仕様書通りには動かないし、現実のブラウザは要件定義書通りには動かないし、現実の組織は議事録通りには動かない。その差異を吸収しようとするほど、コードは複雑になり、責任は曖昧になり、品質は脆くなる。</p>

        <p>「すべてに対応する」という呪縛から解放されたとき、本当に守るべきものが見えてくる。端末にとっても、ブラウザにとっても、組織にとっても、それは「どこでも使える」ではなく、「使う場所で確実に動く」だ。</p>

        <blockquote>
            万能を目指すことは、何も守らないことに等しい。<br>
            境界を認めることが、品質の始まりだ。
        </blockquote>

        <p>30以上のPRを経てChromeだけに絞ったあの日、技術的には何も解決していない。Safariの<code>overflow: hidden</code>無視は変わらない。<code>height</code>制約の無視も残っている。変わったのは、設計者としての視座だ。</p>

        <p>捨てる決断、境界を引く決断。それは「できません」という敗北宣言ではない。「ここに境界がある」という発見の記録だ。そしてその記録を残すこと自体が、同じ場所で立ち止まる次の誰かへの、静かな贈り物になる。</p>

        <p>すべてを提供することが善ではない。確実に届くものだけを提供し、その判断の過程を記録に残すことが、善だ。</p>

        <div class="key-point">
            <p>失う決断の先に、守るべきものが見える。<br>機種依存も、ブラウザ依存も、組織依存も、制約ではない。設計の起点だ。</p>
        </div>

    </article>

    <footer class="article-footer">
        <p id="essay-nav-links"></p>
        <p style="margin-top: 2rem; font-size: 0.75rem;">&copy; 2026 TokiStorage</p>
    </footer>

</main>

<script src="contact-form.js"></script>
<script src="essay-nav.js?v=20260220"></script>
<script src="tracker.js"></script>
</body>
</html>