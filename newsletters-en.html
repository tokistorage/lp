<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="32x32" href="asset/favicon-32.png">
    <link rel="apple-touch-icon" sizes="180x180" href="asset/apple-touch-icon.png">
    <title>Newsletter | TokiStorage</title>
    <meta name="description" content="TokiStorage Newsletter archive. A serial publication deposited with Japan's National Diet Library under the National Diet Library Law. Documenting the mission to make voice a permanent national record.">    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="contact-form.css">
    <style>
        .newsletters-page {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
            padding-top: 6rem;
        }

        .newsletters-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .newsletters-header h1 {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 2.2rem;
            color: #1e293b;
            margin-bottom: 1rem;
        }

        .newsletters-header .lead {
            font-size: 1.1rem;
            color: #64748b;
            max-width: 640px;
            margin: 0 auto;
            line-height: 1.8;
        }

        .pub-meta {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .pub-meta h2 {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1.3rem;
            color: #1e293b;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .pub-meta h2::before {
            content: '';
            width: 4px;
            height: 1.5rem;
            background: #2563EB;
            border-radius: 2px;
        }

        .meta-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1rem;
        }

        .meta-item {
            display: flex;
            gap: 0.75rem;
        }

        .meta-label {
            font-size: 0.8rem;
            color: #94a3b8;
            min-width: 6.5rem;
            flex-shrink: 0;
        }

        .meta-value {
            font-size: 0.9rem;
            color: #1e293b;
        }

        .ndl-context {
            background: #eff6ff;
            border-left: 4px solid #2563EB;
            border-radius: 0 8px 8px 0;
            padding: 1rem 1.5rem;
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: #475569;
            line-height: 1.8;
        }

        .newsletters-section {
            margin-bottom: 4rem;
        }

        .newsletters-section h2 {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1.5rem;
            color: #1e293b;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .newsletters-section h2::before {
            content: '';
            width: 4px;
            height: 1.5rem;
            background: #2563EB;
            border-radius: 2px;
        }

        .newsletter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
        }

        .newsletter-card {
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.2s ease;
            display: flex;
            flex-direction: column;
            text-decoration: none;
            color: inherit;
            cursor: pointer;
        }

        .newsletter-card:hover {
            border-color: #2563EB;
            box-shadow: 0 4px 20px rgba(37, 99, 235, 0.1);
        }

        .card-vol {
            font-size: 0.75rem;
            color: #2563EB;
            font-weight: 600;
            letter-spacing: 0.1em;
            margin-bottom: 0.5rem;
        }

        .card-date {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-bottom: 0.75rem;
        }

        .newsletter-card h3 {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1.15rem;
            color: #1e293b;
            margin-bottom: 0.5rem;
        }

        .newsletter-card p {
            font-size: 0.9rem;
            color: #64748b;
            line-height: 1.7;
            flex: 1;
        }

        .card-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            align-items: center;
        }

        .card-read {
            color: #2563EB;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .card-read::after {
            content: '\2192';
        }

        .card-pdf {
            font-size: 0.8rem;
            color: #94a3b8;
            text-decoration: none;
            padding: 0.2rem 0.6rem;
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            transition: all 0.2s;
        }

        .card-pdf:hover {
            color: #2563EB;
            border-color: #2563EB;
        }

        /* Special Feature Series */
        .series-section {
            margin-bottom: 4rem;
        }

        .series-section h2 {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1.5rem;
            color: #1e293b;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .series-section h2::before {
            content: '';
            width: 4px;
            height: 1.5rem;
            background: #C9A962;
            border-radius: 2px;
        }

        .series-lead {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 1.5rem;
            line-height: 1.7;
        }

        .newsletters-footer {
            text-align: center;
            padding: 3rem 0;
            border-top: 1px solid #e2e8f0;
        }

        .newsletters-footer a {
            color: #2563EB;
            text-decoration: none;
            margin: 0 1rem;
            font-size: 0.9rem;
        }

        .newsletters-footer a:hover {
            text-decoration: underline;
        }

        .newsletters-footer p {
            font-size: 0.8rem;
            color: #94a3b8;
            margin-top: 1.5rem;
        }

        /* ---- Time Accordion ---- */
        .time-group { margin-bottom: 0.5rem; }
        .time-heading {
            display: flex; align-items: center; gap: 0.5rem;
            width: 100%; background: none; border: none;
            padding: 0.5rem 0; cursor: pointer;
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1rem;
            color: #1e293b; text-align: left;
        }
        .time-heading::before {
            content: '\25b6'; font-size: 0.65rem; color: #94a3b8;
            transition: transform 0.2s;
        }
        .time-group.open > .time-heading::before { transform: rotate(90deg); }
        .time-body { display: none; padding-left: 1rem; }
        .time-group.open > .time-body { display: block; }
        .time-count { font-size: 0.75rem; color: #94a3b8; font-weight: normal; }
        [data-level="century"] > .time-heading { font-size: 1.1rem; }
        [data-level="volume"] > .time-heading { font-size: 1rem; }
        [data-level="year"] > .time-heading { font-size: 0.95rem; }
        [data-level="month"] > .time-heading { font-size: 0.9rem; }
        .section-heading {
            font-family: 'Hiragino Mincho ProN', 'Yu Mincho', serif;
            font-size: 1.1rem;
            color: #1e293b;
            margin: 0 0 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #2563EB;
        }
        .section-divider { margin-top: 2rem; }

        .newsletter-status {
            display: inline-block;
            font-size: 0.72rem;
            font-weight: 600;
            letter-spacing: 0.05em;
            padding: 0.2rem 0.7rem;
            border-radius: 2rem;
            margin-bottom: 0.5rem;
        }
        .newsletter-status.published { background: #2563EB; color: #fff; }
        .newsletter-status.drafting { background: #FFF3E0; color: #E65100; }

        @media (max-width: 768px) {
            .newsletters-page { padding-top: 5rem; }
            .newsletters-header h1 { font-size: 1.8rem; }
            .meta-grid { grid-template-columns: 1fr; }
        }
    </style>
    <meta property="og:type" content="article">
    <meta property="og:title" content="Newsletter | TokiStorage">
    <meta property="og:description" content="TokiStorage Newsletter archive. A serial publication deposited with Japan's National Diet Library under the National Diet Library Law. Documenting the mission to make voice a permanent national record.">
    <meta property="og:url" content="https://tokistorage.github.io/lp/newsletters-en.html">
    <meta property="og:site_name" content="TokiStorage">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Newsletter | TokiStorage">
    <meta name="twitter:description" content="TokiStorage Newsletter archive. A serial publication deposited with Japan's National Diet Library under the National Diet Library Law. Documenting the mission to make voice a permanent national record.">
    <meta property="og:image" content="https://tokistorage.github.io/lp/asset/tokistorage-icon-512.png">
    <meta property="og:image:width" content="512">
    <meta property="og:image:height" content="512">
    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebPage",
  "name": "Newsletter | TokiStorage",
  "url": "https://tokistorage.github.io/lp/newsletters-en.html",
  "inLanguage": "en",
  "publisher": {
    "@type": "Organization",
    "name": "TokiStorage",
    "url": "https://tokistorage.github.io/lp"
  },
  "description": "TokiStorage Newsletter archive. A serial publication deposited with Japan's National Diet Library under the National Diet Library Law. Documenting the mission to make voice a permanent national record."
}
    </script>
    <link rel="alternate" hreflang="ja" href="https://tokistorage.github.io/lp/newsletters.html">
    <link rel="alternate" hreflang="en" href="https://tokistorage.github.io/lp/newsletters-en.html">
    <link rel="alternate" hreflang="x-default" href="https://tokistorage.github.io/lp/newsletters.html">
    <link rel="canonical" href="https://tokistorage.github.io/lp/newsletters-en.html">
</head>
<body>

<nav class="toki-nav">
    <a href="index-en.html" class="nav-logo">TokiStorage</a>
    <div class="nav-links">
        <a href="index-en.html#how">How It Works</a>
        <a href="index-en.html#pricing">Pricing</a>
        <a href="details-en.html">Learn More</a>
        <a href="newsletters.html" class="lang-switch" aria-label="日本語に切替">JA</a>
    </div>
    <button class="nav-toggle" aria-label="Menu">
        <span></span><span></span><span></span>
    </button>
</nav>

<div class="newsletters-page">

    <header class="newsletters-header">
        <h1>Newsletter</h1>
        <p class="lead">A serial publication deposited with Japan's National Diet Library.<br>Documenting TokiStorage's mission to make voice a permanent national record.</p>
    </header>

    <!-- Publication Metadata -->
    <section class="pub-meta">
        <h2>Publication Details</h2>
        <div class="meta-grid">
            <div class="meta-item">
                <span class="meta-label">Title</span>
                <span class="meta-value">TokiStorage Newsletter</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Japanese Title</span>
                <span class="meta-value">トキストレージ ニュースレター</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Publisher</span>
                <span class="meta-value">TokiStorage (Takuya Sato)</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Frequency</span>
                <span class="meta-value">Irregular (multiple issues per year)</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Deposited with</span>
                <span class="meta-value">National Diet Library of Japan</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Format</span>
                <span class="meta-value">PDF (online material)</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Legal basis</span>
                <span class="meta-value">National Diet Library Law, Art. 25 &amp; 25-4</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Inaugural</span>
                <span class="meta-value">February 2026</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Deposit status</span>
                <span class="meta-value">Confirmed for collection &amp; periodic automated harvesting (Ref: EA202602160140)</span>
            </div>
        </div>
        <div class="ndl-context">
            <strong>About the NDL:</strong> The National Diet Library is Japan's equivalent of the U.S. Library of Congress. Under the National Diet Library Law, publishers must deposit copies of their publications, which are then permanently preserved as part of Japan's national heritage. Our numbering follows the <em>Shikinen Sengu</em> model (Ise Shrine's 20-year renewal cycle): 1 Volume = 20 years. 1,000 years = 50 volumes.
        </div>
    </section>

    <!-- Archive -->
    <section class="newsletters-section">
        <h2>Archive</h2>
        <h3 class="section-heading" id="recent-heading"></h3>
        <div class="newsletter-grid" id="recent-list"></div>
        <h3 class="section-heading section-divider" id="all-heading"></h3>
        <div id="all-accordion"></div>
    </section>

    <!-- Special Feature Series -->
    <section class="series-section" id="special-features">
        <h2>Special Feature Series</h2>
        <p class="series-lead">
            Dedicated newsletter series created for each TokiQR Series Rights holder.<br>
            Each series is deposited as an independent serial publication with the National Diet Library.
        </p>
        <p style="text-align: center; margin: 2rem 0;">
            <a href="https://tokistorage.github.io/newsletter-master/" style="display: inline-block; padding: 0.75rem 2rem; background: #C9A962; color: #fff; border-radius: 8px; text-decoration: none; font-size: 0.95rem; font-weight: 500; transition: opacity 0.15s;" onmouseover="this.style.opacity='0.85'" onmouseout="this.style.opacity='1'">View All Series</a>
        </p>
    </section>

    <footer class="newsletters-footer">
        <p style="font-family: Georgia, 'Times New Roman', serif; font-size: 0.8rem; color: #94A3B8; font-style: italic; margin-bottom: 0.8rem;">You become a story, generations connect in dialogue, the path forward.</p>
        <p>&copy; 2026 TokiStorage. All rights reserved.</p>
    </footer>

</div>

<script>
(async function() {
  try {
    var res = await fetch('newsletter/schedule.json');
    if (!res.ok) return;
    var schedule = await res.json();
    var issues = schedule.issues || [];
    if (issues.length === 0) return;

    issues.sort(function(a, b) { return b.date.localeCompare(a.date); });

    var VOLUME_YEARS = 20, START_YEAR = 2026;
    var statusLabel = { published: 'Published', drafting: 'Drafting' };
    var statusClass = { published: 'published', drafting: 'drafting' };
    var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];

    function ordinal(n) {
      if (n % 100 >= 11 && n % 100 <= 13) return n + 'th';
      switch (n % 10) { case 1: return n + 'st'; case 2: return n + 'nd'; case 3: return n + 'rd'; default: return n + 'th'; }
    }

    function renderCard(i) {
      var serial5 = String(i.serial).padStart(5, '0');
      var href = i.page_url_en || i.page_url || '#';
      var html = '<a href="' + href + '" class="newsletter-card">'
        + '<div class="card-vol">VOL.' + i.volume + ' NO.' + i.number + ' — SERIAL #' + serial5 + '</div>'
        + '<span class="newsletter-status ' + (statusClass[i.status] || '') + '">' + (statusLabel[i.status] || i.status) + '</span>'
        + '<div class="card-date">' + months[parseInt(i.date.slice(5, 7)) - 1] + ' ' + i.date.slice(0, 4) + '</div>'
        + '<h3>' + (i.title_en || 'No. ' + i.serial) + '</h3>'
        + '<div class="card-actions"><span class="card-read">Read more</span>';
      if (i.status === 'published' && i.pdf_url) {
        html += '<span class="card-pdf" onclick="event.preventDefault();event.stopPropagation();window.location.href=\'' + i.pdf_url + '\';">PDF</span>';
      }
      html += '</div></a>';
      return html;
    }

    // Recent section
    var recent = issues.slice(0, 10);
    document.getElementById('recent-heading').textContent = 'Recent Issues';
    document.getElementById('recent-list').innerHTML = recent.map(renderCard).join('');

    // Build time hierarchy: century > volume > year > month
    function buildAccordion(items) {
      var tree = {};
      items.forEach(function(i) {
        var y = parseInt(i.date.slice(0, 4));
        var m = parseInt(i.date.slice(5, 7));
        var c = Math.floor((y - 1) / 100) + 1;
        var v = Math.floor((y - START_YEAR) / VOLUME_YEARS) + 1;
        if (!tree[c]) tree[c] = {};
        if (!tree[c][v]) tree[c][v] = {};
        if (!tree[c][v][y]) tree[c][v][y] = {};
        if (!tree[c][v][y][m]) tree[c][v][y][m] = [];
        tree[c][v][y][m].push(i);
      });

      function countLeaves(node) {
        if (Array.isArray(node)) return node.length;
        var n = 0; Object.keys(node).forEach(function(k) { n += countLeaves(node[k]); }); return n;
      }

      var html = '';
      var centuries = Object.keys(tree).map(Number).sort(function(a,b){return b-a;});
      centuries.forEach(function(c) {
        var cCount = countLeaves(tree[c]);
        html += '<div class="time-group" data-level="century"><button class="time-heading">'
          + ordinal(c) + ' century <span class="time-count">' + cCount + ' item' + (cCount !== 1 ? 's' : '') + '</span></button><div class="time-body">';
        var vols = Object.keys(tree[c]).map(Number).sort(function(a,b){return b-a;});
        vols.forEach(function(v) {
          var vCount = countLeaves(tree[c][v]);
          var vs = START_YEAR + (v - 1) * VOLUME_YEARS;
          var ve = vs + VOLUME_YEARS - 1;
          html += '<div class="time-group" data-level="volume"><button class="time-heading">'
            + 'Vol. ' + v + ' (' + vs + '\u2013' + ve + ') <span class="time-count">' + vCount + ' item' + (vCount !== 1 ? 's' : '') + '</span></button><div class="time-body">';
          var years = Object.keys(tree[c][v]).map(Number).sort(function(a,b){return b-a;});
          years.forEach(function(y) {
            var yCount = countLeaves(tree[c][v][y]);
            html += '<div class="time-group" data-level="year"><button class="time-heading">'
              + y + ' <span class="time-count">' + yCount + ' item' + (yCount !== 1 ? 's' : '') + '</span></button><div class="time-body">';
            var ms = Object.keys(tree[c][v][y]).map(Number).sort(function(a,b){return b-a;});
            ms.forEach(function(m) {
              var mItems = tree[c][v][y][m];
              html += '<div class="time-group" data-level="month"><button class="time-heading">'
                + months[m - 1] + ' <span class="time-count">' + mItems.length + ' item' + (mItems.length !== 1 ? 's' : '') + '</span></button><div class="time-body">'
                + '<div class="newsletter-grid">' + mItems.map(renderCard).join('') + '</div>'
                + '</div></div>';
            });
            html += '</div></div>';
          });
          html += '</div></div>';
        });
        html += '</div></div>';
      });
      return html;
    }

    document.getElementById('all-heading').textContent = 'All Archives';
    document.getElementById('all-accordion').innerHTML = buildAccordion(issues);

    // Accordion toggle
    document.querySelectorAll('.time-heading').forEach(function(btn) {
      btn.addEventListener('click', function() {
        this.parentElement.classList.toggle('open');
      });
    });
  } catch (e) {}
})();
</script>
<script src="index.js" defer></script>
<script src="contact-form.js" defer></script>
<script src="tracker.js" defer></script>
</body>
</html>
